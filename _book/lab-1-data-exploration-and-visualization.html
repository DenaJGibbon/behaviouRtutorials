<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Lab 1. Data exploration and visualization | behaviouR: R package and tutorials for online teaching of fundamental concepts in behavior and ecology</title>
  <meta name="description" content="This is the location for all of the tutorials associated with the behaviouR R package." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Lab 1. Data exploration and visualization | behaviouR: R package and tutorials for online teaching of fundamental concepts in behavior and ecology" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is the location for all of the tutorials associated with the behaviouR R package." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Lab 1. Data exploration and visualization | behaviouR: R package and tutorials for online teaching of fundamental concepts in behavior and ecology" />
  
  <meta name="twitter:description" content="This is the location for all of the tutorials associated with the behaviouR R package." />
  

<meta name="author" content="Dena J. Clink" />


<meta name="date" content="2020-08-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="lab-2-activity-budgets-and-ethograms.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">BioNBB 2210 Summer 2020 Computer Labs</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="lab-1-data-exploration-and-visualization.html"><a href="lab-1-data-exploration-and-visualization.html"><i class="fa fa-check"></i><b>1</b> Lab 1. Data exploration and visualization</a><ul>
<li class="chapter" data-level="" data-path="lab-1-data-exploration-and-visualization.html"><a href="lab-1-data-exploration-and-visualization.html#lab-1a.-categorical-data"><i class="fa fa-check"></i>Lab 1a. Categorical data</a></li>
<li class="chapter" data-level="" data-path="lab-1-data-exploration-and-visualization.html"><a href="lab-1-data-exploration-and-visualization.html#lab-1b.-categorical-and-continuous-data"><i class="fa fa-check"></i>Lab 1b. Categorical and continuous data</a></li>
<li class="chapter" data-level="" data-path="lab-1-data-exploration-and-visualization.html"><a href="lab-1-data-exploration-and-visualization.html#lab-1c.-categorical-and-continuous-data"><i class="fa fa-check"></i>Lab 1c. Categorical and continuous data</a></li>
<li class="chapter" data-level="" data-path="lab-1-data-exploration-and-visualization.html"><a href="lab-1-data-exploration-and-visualization.html#lab-1d.-multivariate-data"><i class="fa fa-check"></i>Lab 1d. Multivariate data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lab-2-activity-budgets-and-ethograms.html"><a href="lab-2-activity-budgets-and-ethograms.html"><i class="fa fa-check"></i><b>2</b> Lab 2. Activity Budgets and Ethograms</a><ul>
<li class="chapter" data-level="" data-path="lab-2-activity-budgets-and-ethograms.html"><a href="lab-2-activity-budgets-and-ethograms.html#lab-2a.-enter-and-visualize-your-ethogram-data"><i class="fa fa-check"></i>Lab 2a. Enter and visualize your ethogram data</a></li>
<li class="chapter" data-level="" data-path="lab-2-activity-budgets-and-ethograms.html"><a href="lab-2-activity-budgets-and-ethograms.html#lab-2b.-calculate-meerkat-activity-budgets."><i class="fa fa-check"></i>Lab 2b. Calculate meerkat activity budgets.</a></li>
<li class="chapter" data-level="" data-path="lab-2-activity-budgets-and-ethograms.html"><a href="lab-2-activity-budgets-and-ethograms.html#lab-2c.-scan-sampling-and-inter-observer-reliability."><i class="fa fa-check"></i>Lab 2c. Scan sampling and inter-observer reliability.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html"><i class="fa fa-check"></i><b>3</b> Lab 3. Analyzing Acoustic Data</a><ul>
<li class="chapter" data-level="" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-1.-loading-a-sound-file-and-making-a-spectrogram"><i class="fa fa-check"></i>Part 1. Loading a sound file and making a spectrogram</a></li>
<li class="chapter" data-level="" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-2.-visualizing-differences-in-gibbon-and-great-argus-calls"><i class="fa fa-check"></i>Part 2. Visualizing differences in gibbon and great argus calls</a></li>
<li class="chapter" data-level="" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-3.-soundscapes"><i class="fa fa-check"></i>Part 3. Soundscapes</a></li>
<li class="chapter" data-level="" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-4.-now-it-is-time-to-analyze-the-data-you-collected-for-this-weeks-field-lab."><i class="fa fa-check"></i>Part 4. Now it is time to analyze the data you collected for this week’s field lab.</a><ul>
<li class="chapter" data-level="3.0.1" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-4a.-your-focal-recordings"><i class="fa fa-check"></i><b>3.0.1</b> Part 4a. Your focal recordings</a></li>
<li class="chapter" data-level="3.0.2" data-path="lab-3-analyzing-acoustic-data.html"><a href="lab-3-analyzing-acoustic-data.html#part-4b.-soundscape-recordings"><i class="fa fa-check"></i><b>3.0.2</b> Part 4b. Soundscape recordings</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="lab-4-vigilance-behavior.html"><a href="lab-4-vigilance-behavior.html"><i class="fa fa-check"></i><b>4</b> Lab 4. Vigilance behavior</a><ul>
<li class="chapter" data-level="4.1" data-path="lab-4-vigilance-behavior.html"><a href="lab-4-vigilance-behavior.html#part-1-barnacle-goose-vigilance"><i class="fa fa-check"></i><b>4.1</b> Part 1: Barnacle goose vigilance</a><ul>
<li class="chapter" data-level="4.1.1" data-path="lab-4-vigilance-behavior.html"><a href="lab-4-vigilance-behavior.html#part-1a-surveillance-behavior"><i class="fa fa-check"></i><b>4.1.1</b> Part 1a: Surveillance behavior</a></li>
<li class="chapter" data-level="4.1.2" data-path="lab-4-vigilance-behavior.html"><a href="lab-4-vigilance-behavior.html#part-1b-time-vigilant-secmin"><i class="fa fa-check"></i><b>4.1.2</b> Part 1b: Time vigilant (sec/min)</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="lab-4-vigilance-behavior.html"><a href="lab-4-vigilance-behavior.html#part-2-meerkat-data-revisted"><i class="fa fa-check"></i><b>4.2</b> Part 2: Meerkat data revisted</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html"><i class="fa fa-check"></i><b>5</b> Lab 5. Estimating Population Density and Biodiversity</a><ul>
<li class="chapter" data-level="5.1" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#part-1.-population-density-estimation."><i class="fa fa-check"></i><b>5.1</b> Part 1. Population density estimation.</a></li>
<li class="chapter" data-level="5.2" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#part-2.-comparing-biodiversity."><i class="fa fa-check"></i><b>5.2</b> Part 2. Comparing biodiversity.</a><ul>
<li class="chapter" data-level="5.2.1" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#alpha-diversity."><i class="fa fa-check"></i><b>5.2.1</b> Alpha diversity.</a></li>
<li class="chapter" data-level="5.2.2" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#beta-diversity."><i class="fa fa-check"></i><b>5.2.2</b> Beta diversity.</a></li>
<li class="chapter" data-level="5.2.3" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#now-we-will-use-your-partners-data-to-estimate-alpha-diversity"><i class="fa fa-check"></i><b>5.2.3</b> Now we will use your partner’s data to estimate alpha diversity</a></li>
<li class="chapter" data-level="5.2.4" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#gamma-diversity"><i class="fa fa-check"></i><b>5.2.4</b> Gamma diversity</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="lab-5-estimating-population-density-and-biodiversity.html"><a href="lab-5-estimating-population-density-and-biodiversity.html#part-3.-biodiversity-indices-in-the-real-world."><i class="fa fa-check"></i><b>5.3</b> Part 3. Biodiversity indices in the real world.</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="lab-6-analyzing-camera-trap-data-.html"><a href="lab-6-analyzing-camera-trap-data-.html"><i class="fa fa-check"></i><b>6</b> Lab 6. Analyzing camera trap data.</a><ul>
<li class="chapter" data-level="6.1" data-path="lab-6-analyzing-camera-trap-data-.html"><a href="lab-6-analyzing-camera-trap-data-.html#part-1-collect-serengeti-camera-trap-data"><i class="fa fa-check"></i><b>6.1</b> Part 1: Collect Serengeti camera trap data</a></li>
<li class="chapter" data-level="6.2" data-path="lab-6-analyzing-camera-trap-data-.html"><a href="lab-6-analyzing-camera-trap-data-.html#part-2-analyze-your-serengeti-camera-trap-data"><i class="fa fa-check"></i><b>6.2</b> Part 2: Analyze your Serengeti camera trap data</a></li>
<li class="chapter" data-level="6.3" data-path="lab-6-analyzing-camera-trap-data-.html"><a href="lab-6-analyzing-camera-trap-data-.html#part-3-focus-on-your-partners-serengeti-camera-trap-data"><i class="fa fa-check"></i><b>6.3</b> Part 3: Focus on your partner’s Serengeti camera trap data</a></li>
<li class="chapter" data-level="6.4" data-path="lab-6-analyzing-camera-trap-data-.html"><a href="lab-6-analyzing-camera-trap-data-.html#part-4.-investigating-temporal-niche-partitioning-in-four-different-animals"><i class="fa fa-check"></i><b>6.4</b> Part 4. Investigating temporal niche partitioning in four different animals</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="appendix-1-data-exploration-and-visualization-r-script.html"><a href="appendix-1-data-exploration-and-visualization-r-script.html"><i class="fa fa-check"></i>Appendix 1. Data exploration and visualization R script</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">behaviouR: R package and tutorials for online teaching of fundamental concepts in behavior and ecology</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lab-1.-data-exploration-and-visualization" class="section level1">
<h1><span class="header-section-number">1</span> Lab 1. Data exploration and visualization</h1>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><em>Background</em><br />
Our examples will focus on roaring behavior in red deer. Red deer on Rum Island, Scotland form harems during the mating season. Harem holding males fight off other males during this time, and many of these males have signs of fighting injuries. Clutton-Brock and colleagues hypothesized that because of the injury associated with fights that red deer males should use honest indicators of each others fighting abilities, and that the main indicator of strength and fighting ability was the male roars.</p>
<p><em>For more background see</em>:
Clutton-Brock, Tim H., and Steven D. Albon. “The roaring of red deer and the evolution of honest advertisement.” <em>Behaviour</em> 69.3-4 (1979): 145-170.</p>
<p>Reby D, McComb K. Anatomical constraints generate honesty: acoustic cues to age and weight in the roars of red deer stags. Animal behaviour. 2003 Mar 1;65(3):519-30.</p>
<p>Long, A. M., N. P. Moore, and T. J. Hayden. “Vocalizations in red deer (<em>Cervus elaphus</em>), sika deer (<em>Cervus nippon</em>), and red× sika hybrids.” Journal of Zoology 244.1 (1998): 123-134.</p>
<p><em>Goals of the exercises</em><br />
The main goal(s) of today’s lab are to:<br />
1) teach you about different types of data visualization and types of data.<br />
2) help you to start to become familiar with using R.<br />
3) to get you to think about the ways that scientists analyze data.</p>
<p><em>Getting started</em><br />
First we need to load the relevant package. Packages contain all the functions that are needed for data analysis. The ‘behaviouR’ package loads many other packages that have important functions.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># First we load the relevant packages</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(behaviouR)</a></code></pre></div>
<div id="lab-1a.-categorical-data" class="section level2 unnumbered">
<h2>Lab 1a. Categorical data</h2>
<p>Categorical variables represent types of data that can be divided into groups.
Our first example will census a simulated population of red deer to determine the proportion of individuals in different developmental stages.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">## Lab 1a. Categorical data</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># Here we create a simulated population with four categories (Infant, Juvenile, AdultFemale and AdultMale)</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">DeerPopulationDF &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">DevelopmentStage=</span><span class="kw">c</span>(<span class="st">&#39;Infant&#39;</span>,<span class="st">&#39;Juvenile&#39;</span>,<span class="st">&#39;AdultFemale&#39;</span>,<span class="st">&#39;AdultMale&#39;</span>),</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">                         <span class="dt">NumberOfIndividuals=</span><span class="kw">c</span>(<span class="dv">15</span>,<span class="dv">50</span>,<span class="dv">125</span>,<span class="dv">200</span>))</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co"># We then print the object so that we can see the output</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">DeerPopulationDF</a></code></pre></div>
<pre><code>##   DevelopmentStage NumberOfIndividuals
## 1           Infant                  15
## 2         Juvenile                  50
## 3      AdultFemale                 125
## 4        AdultMale                 200</code></pre>
<p>Now we want to plot the data. We will use a simple barplot to start.</p>
<p>Throughout these tutorials we will use functions from the ‘ggpubr’ package for plotting; see <a href="https://rpkgs.datanovia.com/ggpubr/" class="uri">https://rpkgs.datanovia.com/ggpubr/</a> for more details. For more information on the great work the developer is doing see <a href="http://www.alboukadel.com/" class="uri">http://www.alboukadel.com/</a> and <a href="http://www.sthda.com/english/" class="uri">http://www.sthda.com/english/</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Now we want to plot the data. We will use a simple barplot to start.</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">ggbarplot</span>(DeerPopulationDF, <span class="dt">x=</span><span class="st">&#39;DevelopmentStage&#39;</span>, <span class="dt">y=</span><span class="st">&#39;NumberOfIndividuals&#39;</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p><em>Please answer the following questions:</em><br />
Question 1. How would you interpret this figure? Which category has the most individuals, and which has the least?</p>
<p>Question 2a. This is a simulated popuation, but what do you think the ratio of males to females would mean for male-male competition?</p>
<p>Question 2b. Modify the code above so that our simulated deer population has a more even ratio of males to females.</p>
</div>
<div id="lab-1b.-categorical-and-continuous-data" class="section level2 unnumbered">
<h2>Lab 1b. Categorical and continuous data</h2>
<p>Our second example will investigate roaring rates in deer as a function of status and breeding season.The categories we will use are: pre-mating season, harem holder, not harem holder and post-mating season.Our outcome variable (mean number of roars per minute) is continuous; it represents actual numerical measurements.</p>
<p>I created a toy dataset which is based on Figure 2 in Clutton-Brock et al. 1979 where for each category we have five observations which represent the average number of calls per minute. For each category we have a total of five observations.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">## Lab 1b. Categorical and continuous data</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># Load the dataset so that we can use it </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">data</span>(<span class="st">&quot;MaleDeerRoarDF&quot;</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co"># We can check the structure of the dataframe by using the command &#39;head&#39;</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw">head</span>(MaleDeerRoarDF)</a></code></pre></div>
<pre><code>##      MaleCategory RoarsPerMinute
## 1 PreMatingSeason           0.25
## 2 PreMatingSeason           0.50
## 3 PreMatingSeason           0.25
## 4 PreMatingSeason           0.30
## 5 PreMatingSeason           0.10
## 6    HaremHolders           2.50</code></pre>
<p>Now we will plot the categorical data. First we will use a barplot with error bars representing the standard deviation. See <a href="https://www.biologyforlife.com/interpreting-error-bars.html" class="uri">https://www.biologyforlife.com/interpreting-error-bars.html</a> and <a href="https://www.biologyforlife.com/standard-deviation.html" class="uri">https://www.biologyforlife.com/standard-deviation.html</a> for more information about error bars.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Now we will plot the categorical data with standard deviations. </span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw">ggbarplot</span>(MaleDeerRoarDF, <span class="dt">x=</span><span class="st">&#39;MaleCategory&#39;</span>, <span class="dt">y=</span><span class="st">&#39;RoarsPerMinute&#39;</span>, </a>
<a class="sourceLine" id="cb8-3" data-line-number="3">          <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_sd&quot;</span>),<span class="dt">xtickslab.rt =</span> <span class="dv">90</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Although it shows us what we need, we can also include some colors in our plot. To do this I added the ‘fill = ’MaleCategory’ argument, which tells R to color the plot based on male categories.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># Now we will plot the categorical data with colors for each category.</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw">ggbarplot</span>(MaleDeerRoarDF, <span class="dt">x=</span><span class="st">&#39;MaleCategory&#39;</span>, <span class="dt">y=</span><span class="st">&#39;RoarsPerMinute&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;MaleCategory&#39;</span>,</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">          <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_sd&quot;</span>),<span class="dt">xtickslab.rt =</span> <span class="dv">90</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Color for plots is often based on personal preference, below I modified the colors using the ‘palette’ argument.
NOTE: The use of color-blind friendly palettes is becoming increasingly popular among scientists.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># Now we will plot the categorical data with user-specified colors for each category.</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">ggbarplot</span>(MaleDeerRoarDF, <span class="dt">x=</span><span class="st">&#39;MaleCategory&#39;</span>, <span class="dt">y=</span><span class="st">&#39;RoarsPerMinute&#39;</span>, <span class="dt">fill =</span> <span class="st">&#39;MaleCategory&#39;</span>,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">          <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;gray&#39;</span>,<span class="st">&#39;white&#39;</span>,<span class="st">&#39;black&#39;</span>),</a>
<a class="sourceLine" id="cb10-4" data-line-number="4">          <span class="dt">add =</span> <span class="kw">c</span>(<span class="st">&quot;mean_se&quot;</span>),<span class="dt">xtickslab.rt =</span> <span class="dv">90</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p><em>Please answer the following questions:</em></p>
<p>Question 3. How do you interpret the barplot figure?</p>
<p>Question 4. Visit this site (<a href="http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf" class="uri">http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf</a>) and change the colors of the plot. Hint: change ‘palette = c(’red’,‘gray’,‘white’,‘black’)‘to ’palette = c(’color1’,‘color2’,‘color3’,‘color4’)’.</p>
</div>
<div id="lab-1c.-categorical-and-continuous-data" class="section level2 unnumbered">
<h2>Lab 1c. Categorical and continuous data</h2>
<p>Continuous data represent numerical measurements, and when both our variables of interest are continuous we can plot them in a different way.</p>
<p>For this example we will consider the relationship between male red deer body weight (in kilograms) and male reproductive success (which is estimated by the number of days that he associated with females during the breeding season).</p>
<p>Below we have a function that will simulate data for us, and we can specify the level of correlation.</p>
<p>We also assign a mean body weight for males in our population (I got this value from ). We can also change the male reproductive success value. Our starting correlation value between these two variables is that reported in Reby &amp; McComb 2003.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">## Lab 1c. Categorical and continuous data</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="co"># This is the function that simulates our data. N is the number of individuals,   </span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="co"># CorrelationCoefficient tells us how correlated our data are,  </span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="co"># MaleMeanBodyWeight is the mean body weight of males in our population and </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="co"># MeanFemalesInHarem is the mean number of females in the harem.</span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6">MaleRedDeerDF &lt;-<span class="st"> </span><span class="kw">CorrelatedDataSimulationFunction</span>(<span class="dt">N=</span><span class="dv">100</span>, </a>
<a class="sourceLine" id="cb11-7" data-line-number="7">                                                  <span class="dt">CorrelationCoefficient=</span> <span class="fl">0.45</span>,</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">                                                  <span class="dt">MaleMeanBodyWeight =</span> <span class="dv">125</span>,</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">                                                  <span class="dt">MaleReproductiveSuccess =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb11-10" data-line-number="10"></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co"># We can check the output</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="kw">head</span>(MaleRedDeerDF)</a></code></pre></div>
<pre><code>##   MaleBodyWeight MaleReproductiveSuccess
## 1       125.2576                3.466009
## 2       125.1888                1.658102
## 3       124.7266                2.858253
## 4       124.1372                2.455370
## 5       125.4283                1.643711
## 6       124.3844                2.272255</code></pre>
<p>Now we plot the data the data as before, but this time we make a scatterplot</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co"># Make a scatterplot of the data.</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2"><span class="kw">ggscatter</span>(<span class="dt">data=</span>MaleRedDeerDF,<span class="dt">x=</span><span class="st">&#39;MaleBodyWeight&#39;</span>,<span class="dt">y=</span><span class="st">&#39;MaleReproductiveSuccess&#39;</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>It looks like there is a correlation between our two variables, but it would be better visualized with a trend line.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="co"># Make a scatterplot with a trendline.</span></a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">ggscatter</span>(<span class="dt">data=</span>MaleRedDeerDF,<span class="dt">x=</span><span class="st">&#39;MaleBodyWeight&#39;</span>,<span class="dt">y=</span><span class="st">&#39;MaleReproductiveSuccess&#39;</span>,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">          <span class="dt">add=</span><span class="st">&#39;reg.line&#39;</span>)</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>Now we can use R to create a linear model to quantitatively investigate the relationship between our two variables</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co"># Create a linear model where MaleBodyWeight is the independent variable</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co"># and FemalesInHarem is the dependent variable.</span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3">MaleDeerModel &lt;-<span class="st"> </span><span class="kw">lm</span>(MaleReproductiveSuccess <span class="op">~</span><span class="st"> </span>MaleBodyWeight,<span class="dt">data=</span>MaleRedDeerDF)</a></code></pre></div>
<p>We can look at the output of the model and we see that our coefficient for MaleBodyWeight is 0.83. We interpret this to mean that for every 1 kg increase in male body mass, we would expect to see a 0.83 increase in the number of females in his harem.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># We can look at the output of the model  </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">MaleDeerModel</a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = MaleReproductiveSuccess ~ MaleBodyWeight, data = MaleRedDeerDF)
## 
## Coefficients:
##    (Intercept)  MaleBodyWeight  
##         -53.25            0.45</code></pre>
<p>There are many ways that we can test whether the results of our model are reliable. A common way is through the use of p-values; a somewhat more intuitive way is through the use of model comparison using Akaike information criterion (AIC). AIC provides an estimate of how well the model fits the data.</p>
<p>NOTE: AIC can be used to compare two our more models created using the same dataset, but the relative AIC values are what is important, and you must use the same data for all models.</p>
<p>We will set up two models for this exercise. Our first model will be our ’null’model which does not include MaleBodyWeight as a predictor. Our next model will be our model of interest that does contain MaleBodyWeight as a predictor.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="co"># Create a null model and a model with MaleBodyWeight as a predictor.</span></a>
<a class="sourceLine" id="cb18-2" data-line-number="2">MaleDeerNull &lt;-<span class="st"> </span><span class="kw">lm</span>(MaleReproductiveSuccess <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data=</span>MaleRedDeerDF)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">MaleDeerModel &lt;-<span class="st"> </span><span class="kw">lm</span>(MaleReproductiveSuccess <span class="op">~</span><span class="st"> </span>MaleBodyWeight,<span class="dt">data=</span>MaleRedDeerDF)</a></code></pre></div>
<p>We can now use a function created to compare models using a modified version of AIC (adjusted for small sample sizes).</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co"># Compare models using AIC.</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">bbmle<span class="op">::</span><span class="kw">AICctab</span>(MaleDeerModel,MaleDeerNull, <span class="dt">weights=</span>T)</a></code></pre></div>
<pre><code>##               dAICc df weight
## MaleDeerModel  0.0  3  1     
## MaleDeerNull  20.5  2  &lt;0.001</code></pre>
<p>NOTE: In this example case the model which contains MaleBodyWeight is ranked higher. We interpret this to mean that there is a reliably positive relationship between MaleBodyWeight and MaleReproductiveSuccess. In other words, as male body weight increases we see an increase in his reproductive success.</p>
<p><em>Please answer the following questions:</em></p>
<p>Question 5a. What happens when you change the correlation coefficent from 0.45 to a much smaller number and re-run the code?</p>
<p>Question 5b. What about when you change it to a much bigger number?</p>
</div>
<div id="lab-1d.-multivariate-data" class="section level2 unnumbered">
<h2>Lab 1d. Multivariate data</h2>
<p>In some cases we have multiple measurements of different variables from the same individual; in this case our data would be considered ‘multivariate’.</p>
<p>Lets create a toy dataset of red deer, sika deer and red x sika hybrid vocalizations (based on Long et al. 1998). We will simulate four vocalizations per individual and we will measure three aspects of the vocalizations- the duration, the minimum frequency and the maximum frequency of the vocalization. We will then visualize our data using principal component analysis (PCA). PCA is a commonly used data reduction technique.</p>
<p>For more information see <a href="https://www.nature.com/articles/nmeth.4346.pdf" class="uri">https://www.nature.com/articles/nmeth.4346.pdf</a>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">## Lab 1d. Multivariate data</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="co"># Just as before we load our data</span></a>
<a class="sourceLine" id="cb21-3" data-line-number="3"><span class="kw">data</span>(<span class="st">&quot;DeerSpeciesAcousticFeatures&quot;</span>)</a>
<a class="sourceLine" id="cb21-4" data-line-number="4"></a>
<a class="sourceLine" id="cb21-5" data-line-number="5"><span class="co"># Check the structure</span></a>
<a class="sourceLine" id="cb21-6" data-line-number="6"><span class="kw">head</span>(DeerSpeciesAcousticFeatures)</a></code></pre></div>
<pre><code>##   Duration MinFrequency MaxFrequency   Class
## 1       15           50          125 RedDeer
## 2       14           49          127 RedDeer
## 3       12           51          126 RedDeer
## 4       13           52          127 RedDeer
## 5       17           35          125 Hybrids
## 6       19           37          126 Hybrids</code></pre>
<p>Now we run the PCA. Note: You can only do PCA on numeric data, so we remove the class category.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="co"># Here is our modified dataset that we will use for PCA</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2">DeerSpeciesAcousticFeatures[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>)] </a></code></pre></div>
<pre><code>##    Duration MinFrequency MaxFrequency
## 1        15           50          125
## 2        14           49          127
## 3        12           51          126
## 4        13           52          127
## 5        17           35          125
## 6        19           37          126
## 7        15           34          123
## 8        16           32          127
## 9        21           20          125
## 10       22           20          126
## 11       23           21          124
## 12       20           25          127</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="co"># Run the PCA using the &#39;princomp&#39; function</span></a>
<a class="sourceLine" id="cb25-2" data-line-number="2">DeerSpeciesAcousticFeaturesPCA &lt;-<span class="st"> </span><span class="kw">princomp</span>(DeerSpeciesAcousticFeatures[,<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>)])</a></code></pre></div>
<p>Then we will plot the results
NOTE: each point represents one roar and the colors represent the class category.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="co"># Plot the results of our PCA.</span></a>
<a class="sourceLine" id="cb26-2" data-line-number="2">ggplot2<span class="op">::</span><span class="kw">autoplot</span>(DeerSpeciesAcousticFeaturesPCA, <span class="dt">data =</span> DeerSpeciesAcousticFeatures, <span class="dt">colour =</span> <span class="st">&#39;Class&#39;</span>,</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">         <span class="dt">loadings =</span> <span class="ot">FALSE</span>)<span class="op">+</span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>What if we are interested in which features best distinguish between our groups?
We can visulize this using the following code:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="co"># Plot the PCA with arrows indicating which features are important for distinguishing between groups</span></a>
<a class="sourceLine" id="cb27-2" data-line-number="2">ggplot2<span class="op">::</span><span class="kw">autoplot</span>(DeerSpeciesAcousticFeaturesPCA, <span class="dt">data =</span> DeerSpeciesAcousticFeatures, <span class="dt">colour =</span> <span class="st">&#39;Class&#39;</span>,</a>
<a class="sourceLine" id="cb27-3" data-line-number="3">         <span class="dt">loadings =</span> <span class="ot">TRUE</span>, <span class="dt">loadings.colour =</span> <span class="st">&#39;red&#39;</span>,</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">         <span class="dt">loadings.label =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb27-5" data-line-number="5">         <span class="dt">loadings.label.size =</span> <span class="dv">5</span>)<span class="op">+</span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="behaviouR-R-package-tutorials_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>This shows that the feature that best distinguishes between red deer and sika is the minimum frequency of their vocalizations. If you look on the x-axis (Comp.1) you can see that there is a substantial amount of separation between these groups.</p>
<p><em>Please answer the following questions:</em></p>
<p>Question 6. In your own words, explain why we would want to use PCA for data visualization? What can we learn about the data when it is visualized this way?</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lab-2-activity-budgets-and-ethograms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/01-Lab-1-Data-exploration-and-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["behaviouR-R-package-tutorials.pdf", "behaviouR-R-package-tutorials.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
